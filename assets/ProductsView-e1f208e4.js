import{_ as V,m as b,A as L,a as I,r as _,o as n,b as l,d as t,l as q,w as g,p as v,f as m,g as y,n as P,F as x,e as w,v as U,t as u,q as E,k as R,L as A,h as k,j as N,s as B,u as D}from"./index-07ab4bc2.js";import{c as C}from"./cart-b6e0a86a.js";import{p as j}from"./PaginationView-92cfe60e.js";import{T as M}from"./toast-10d57006.js";const O="/headphone/assets/products-banner-e1295836.jpg";const{VITE_URL:p,VITE_PATH:h}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"test8283",BASE_URL:"/headphone/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},z={inject:["currency"],data(){return{bannerImg:O,products:[],filteredProducts:[],selectedCategory:this.$route.query.category,categories:[],selectedSort:"價格高到低",minPrice:null,maxPrice:null,pagination:{}}},methods:{...b(A,["showLoading","hideLoading"]),async getProducts(){try{const e=await this.$http.get(`${p}/api/${h}/products/all`);this.products=e.data.products,await this.getCategories()}catch(e){alert(e.response.data.message)}},async filterProducts(e=1){let s=`${p}/api/${h}/products?page=${e}`;const i=this.$route.query.category;i&&i!=="全部"&&(s=`${p}/api/${h}/products?page=${e}&category=${i}`);try{const a=await this.$http.get(s);this.filteredProducts=a.data.products,this.pagination=a.data.pagination,this.$router.push({path:"products",query:{category:i,page:e}}),this.hideLoading()}catch(a){alert(a.response.data.message)}},getCategories(){const e=[...new Set(this.products.map(s=>s.category))];this.categories=e},async addToCart(e,s=1){const i={product_id:e,qty:s};try{const a=await this.$http.post(`${p}/api/${h}/cart`,{data:i});this.getCart(),M.fire({icon:"success",title:a.data.message,width:250})}catch(a){alert(a.response.data.message)}},sortProducts(){let e=this.$route.query.category==="全部"?this.products:this.products.filter(s=>s.category===this.$route.query.category);this.minPrice!==null&&(e=e.filter(s=>s.price>=this.minPrice)),this.maxPrice!==null&&(e=e.filter(s=>s.price<=this.maxPrice)),this.selectedSort==="價格高到低"?this.filteredProducts=e.sort((s,i)=>i.price-s.price):this.selectedSort==="價格低到高"?this.filteredProducts=e.sort((s,i)=>s.price-i.price):this.filteredProducts=e},...b(C,["getCart"])},components:{pagination:j},async mounted(){try{await this.getProducts(),await this.filterProducts()}catch(e){alert(e.response.data.message)}L.init({duration:1e3,once:!0})},computed:{...I(C,["carts"])},created(){this.showLoading()},watch:{$route:{handler(e){this.showLoading(),e.name==="products"&&this.filterProducts(this.$route.query.page),this.selectedCategory=e.query.category},deep:!0}}},d=e=>(B("data-v-374bc3eb"),e=e(),D(),e),F={class:"container py-8"},H={class:"row gx-4 gy-3"},$={class:"col-lg-3 col-12"},G={class:"p-2 border border-2 rounded-3 position-sticky product-menu",style:{top:"12%"}},J={class:"mb-4 d-md-block d-none"},K=d(()=>t("div",{class:"product-title"},[t("h4",null,"價格")],-1)),Q={class:"d-flex gap-3"},W=d(()=>t("span",null,"-",-1)),X=d(()=>t("div",{class:"product-title"},[t("h4",null,"商品類型")],-1)),Y={class:"px-3 w-md-auto w-100"},Z={class:"mb-1"},tt={class:"col-lg-9 col-12"},et={class:"row gy-2 align-items-center pt-2 pb-3 px-md-0 px-3"},st={class:"col-md-4 col-12"},ot=d(()=>t("option",{value:"照順序排列"},"照順序排列",-1)),rt=d(()=>t("option",{value:"價格低到高"},"價格低到高",-1)),it=d(()=>t("option",{value:"價格高到低"},"價格高到低",-1)),ct=[ot,rt,it],at={class:"col-md-8 col-12"},nt=d(()=>t("hr",null,null,-1)),dt={key:0},lt={class:"row gy-4 py-2"},ut={style:{position:"relative",background:"#f1f1f1"}},pt=["src"],ht=["onClick"],_t={class:"card-body d-flex flex-column"},gt={class:"mb-2 text-title"},mt={class:"text-text mb-2 fs-6"},yt={class:"d-flex align-items-center gap-3 mt-auto mb-2"},ft={class:"text-title text-muted fs-6"},bt={class:"text-title fs-6"},vt={key:1},Pt=d(()=>t("div",{class:"text-center mt-4"},[t("h3",null,"找不到產品")],-1)),xt=[Pt];function wt(e,s,i,a,r,c){const f=_("router-link"),S=_("RouterLink"),T=_("pagination");return n(),l("main",null,[t("div",{class:"banner-img d-flex justify-content-center align-items-center",style:q([{height:"500px"},{backgroundImage:`url(${r.bannerImg})`}])},null,4),t("div",F,[t("div",H,[t("div",$,[t("div",G,[t("div",J,[K,t("div",Q,[t("div",null,[g(t("input",{class:"w-100 border-bottom border-dark bg-transparent p-2",type:"number","onUpdate:modelValue":s[0]||(s[0]=o=>r.minPrice=o),onChange:s[1]||(s[1]=(...o)=>c.sortProducts&&c.sortProducts(...o)),placeholder:"最低"},null,544),[[v,r.minPrice]])]),W,t("div",null,[g(t("input",{class:"w-100 border-bottom border-dark bg-transparent p-2",type:"number","onUpdate:modelValue":s[2]||(s[2]=o=>r.maxPrice=o),onChange:s[3]||(s[3]=(...o)=>c.sortProducts&&c.sortProducts(...o)),placeholder:"最高"},null,544),[[v,r.maxPrice]])])])]),t("div",null,[X,t("ul",Y,[t("li",Z,[m(f,{to:{query:{category:"全部",page:1}},class:P({selected:r.selectedCategory==="全部"})},{default:y(()=>[k(" 全部 ")]),_:1},8,["class"])]),(n(!0),l(x,null,w(r.categories,o=>(n(),l("li",{class:"mb-1",key:o},[m(f,{to:{query:{category:o,page:1}},class:P({selected:r.selectedCategory===o})},{default:y(()=>[k(u(o),1)]),_:2},1032,["to","class"])]))),128))])])])]),t("div",tt,[t("div",et,[t("div",st,[g(t("select",{class:"w-100 p-2 border border-dark rounded-3","onUpdate:modelValue":s[4]||(s[4]=o=>r.selectedSort=o),onChange:s[5]||(s[5]=(...o)=>c.sortProducts&&c.sortProducts(...o))},ct,544),[[U,r.selectedSort]])]),t("div",at,[t("h4",null,u(r.selectedCategory==="全部"?"":r.selectedCategory),1)])]),nt,r.filteredProducts[r.filteredProducts.length-1]?(n(),l("div",dt,[t("div",lt,[(n(!0),l(x,null,w(r.filteredProducts,o=>(n(),l("div",{class:"col-lg-4 col-md-6 col-12",key:o.id,"data-aos":"fade-up"},[m(S,{to:`/product/${o.id}`,class:"card overflow-hidden"},{default:y(()=>[t("div",ut,[t("img",{src:o.imageUrl,class:"card-img-top card-img",alt:""},null,8,pt),t("button",{type:"button",onClick:N(()=>c.addToCart(o.id),["prevent"]),class:"btn btn-primary text-white position-absolute bottom-0 end-0 card-button"}," 加入購物車 ",8,ht)]),t("div",_t,[t("h4",gt,u(o.title),1),t("h4",mt,u(o.description1),1),t("div",yt,[t("del",ft,"NT$ "+u(c.currency(o.origin_price)),1),t("p",bt," NT$ "+u(c.currency(o.price)),1)])])]),_:2},1032,["to"])]))),128))]),r.pagination.total_pages!==1?(n(),E(T,{key:0,pages:r.pagination,onUpdatePage:c.filterProducts},null,8,["pages","onUpdatePage"])):R("",!0)])):(n(),l("div",vt,xt))])])])])}const Vt=V(z,[["render",wt],["__scopeId","data-v-374bc3eb"]]);export{Vt as default};

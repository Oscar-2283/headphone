import{_ as k,m as h,a as w,r as p,o as n,b as r,d as e,f as i,g as D,F as E,e as C,w as f,J as b,t as c,k as S,L as U,n as _}from"./index-73267164.js";import{c as g}from"./cart-101eac90.js";import{T as v}from"./toast-1a5b3917.js";const{VITE_URL:y,VITE_PATH:V}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"test8283",BASE_URL:"/headphone/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},T={inject:["currency"],data(){return{cart:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},code:"",isDiscount:!1}},methods:{...h(U,["hideLoading"]),...h(g,["getCart"]),onSubmit(){this.$http.post(`${y}/api/${V}/order`,{data:this.form}).then(l=>{v.fire({icon:"success",title:l.data.message,width:300}),this.form.message="",this.$refs.form.resetForm(),this.getCart(),this.$router.push(`/cart/payOrder/${l.data.orderId}`)}).catch(l=>alert(l.response.data.message))},useCoupon(){const l={code:this.code};this.$http.post(`${y}/api/${V}/coupon`,{data:l}).then(s=>{this.getCart(),this.total=s.data.total,this.isDiscount=!0,v.fire({icon:"success",title:s.data.message,width:250})}).catch(s=>alert(s.response.data.message))}},computed:{...w(g,["carts","total","final_total"])},watch:{final_total(l){this.isDiscount=l!==this.total}}},F={class:"row g-5 mt-2"},L={class:"col-lg-8 col-12"},q={class:"border border-dark-subtle p-5 bg-white"},I={class:"row gx-5"},R=e("h3",{class:"mb-4"},"訂購資訊",-1),j={class:"mb-3 col-lg-6 col-12"},A=e("label",{for:"姓名",class:"form-label"},"姓名 *",-1),B={class:"mb-3 col-lg-6 col-12"},M=e("label",{for:"email",class:"form-label"},"Email *",-1),O={class:"mb-3 col-lg-6 col-12"},N=e("label",{for:"tel",class:"form-label"},"電話 *",-1),P={class:"mb-3 col-12"},z=e("label",{for:"address",class:"form-label"},"地址 *",-1),H={class:"mb-3 col-12"},J=e("label",{for:"message",class:"form-label"},"留言",-1),G=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-outline-primary"}," 送出訂單 ")],-1),K={class:"col-lg-4 col-12"},Q={class:"border border-dark-subtle p-5 bg-white"},W=e("div",{class:"d-flex justify-content-between w-100"},[e("h3",null,"商品明細")],-1),X={class:"mt-4"},Y={class:"mb-2"},Z={class:"col-3 p-0"},$=["src"],ee={class:"ms-auto"},se=e("hr",null,null,-1),te={class:"my-4"},oe={class:"input-group mb-3 input-group-sm",disabled:""},le={key:0,type:"text",class:"form-control panya-input p-2",placeholder:"已套用優惠券",disabled:""},ae={class:"input-group-append"},ie=["disabled"],ne={class:"d-flex justify-content-between w-100 mb-2"},re={key:0,class:"text-secondary",style:{"font-size":"16px"}},de={key:1},ce={key:0},me={class:"d-flex justify-content-between w-100"},ue=e("h4",null,"折扣後金額:",-1);function _e(l,s,pe,he,t,d){const m=p("VField"),u=p("ErrorMessage"),x=p("VForm");return n(),r("div",F,[e("div",L,[e("div",q,[i(x,{ref:"form",onSubmit:d.onSubmit},{default:D(({errors:o})=>[e("div",I,[R,e("div",j,[A,i(m,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":s[0]||(s[0]=a=>t.form.user.name=a)},null,8,["class","modelValue"]),i(u,{name:"姓名",class:"invalid-feedback"})]),e("div",B,[M,i(m,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":o.email}]),rules:"email|required",placeholder:"請輸入 Email",modelValue:t.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=a=>t.form.user.email=a)},null,8,["class","modelValue"]),i(u,{name:"email",class:"invalid-feedback"})]),e("div",O,[N,i(m,{id:"tel",name:"電話",type:"tel",class:_(["form-control",{"is-invalid":o.電話}]),rules:"required|min:8|max:10|numeric",placeholder:"請輸入電話",modelValue:t.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=a=>t.form.user.tel=a)},null,8,["class","modelValue"]),i(u,{name:"電話",class:"invalid-feedback"})]),e("div",P,[z,i(m,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=a=>t.form.user.address=a)},null,8,["class","modelValue"]),i(u,{name:"地址",class:"invalid-feedback"})]),e("div",H,[J,f(e("textarea",{class:"form-control",id:"message","onUpdate:modelValue":s[4]||(s[4]=a=>t.form.message=a),style:{height:"200px"}},null,512),[[b,t.form.message]])]),G])]),_:1},8,["onSubmit"])])]),e("div",K,[e("div",Q,[W,e("div",X,[e("ul",Y,[(n(!0),r(E,null,C(l.carts,o=>(n(),r("li",{class:"d-flex gap-4 align-items-center",key:o.id},[e("div",Z,[e("img",{style:{"border-radius":"8px"},src:o.product.imageUrl,alt:""},null,8,$)]),e("div",null,[e("h4",null,c(o.product.title),1),e("p",null,"$"+c(d.currency(o.total)),1)]),e("div",ee,"x"+c(o.qty),1)]))),128))]),se]),e("div",te,[e("div",oe,[t.isDiscount?(n(),r("input",le)):f((n(),r("input",{key:1,type:"text",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=o=>t.code=o),placeholder:"請輸入優惠碼"},null,512)),[[b,t.code]]),e("div",ae,[e("button",{disabled:t.isDiscount,onClick:s[6]||(s[6]=o=>d.useCoupon(t.code)),class:"btn btn-outline-primary",style:{"border-radius":"0"},type:"button"}," 套用優惠碼 ",8,ie)])])]),e("div",ne,[t.isDiscount?(n(),r("p",re," 小記: ")):(n(),r("h4",de,"總金額:")),e("h4",null,"$"+c(d.currency(l.total)),1)]),t.isDiscount?(n(),r("div",ce,[e("div",me,[ue,e("h4",null,"$"+c(d.currency(l.final_total)),1)])])):S("",!0)])])])}const ve=k(T,[["render",_e]]);export{ve as default};

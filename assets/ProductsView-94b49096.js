import{_ as C}from"./products-banner-68648edd.js";import{m as V,a as T,r as h,o as d,c as a,b as t,l as I,w as m,v as b,j as g,f,F as v,d as P,p as U,i as q,g as x,t as u,e as E,h as R,q as L,s as N}from"./index-6af05389.js";import{c as k}from"./cart-28123d3c.js";import{p as B}from"./PaginationView-fbb93d16.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";const{VITE_URL:p,VITE_PATH:_}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"test8283",BASE_URL:"/headphone/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},$={inject:["currency"],data(){return{bannerImg:C,products:[],filteredProducts:[],categories:[],selectedSort:"價格高到低",minPrice:null,maxPrice:null,pagination:{}}},methods:{getProducts(){this.$http.get(`${p}/api/${_}/products/all`).then(o=>{this.products=o.data.products,this.getCategories()}).catch(o=>console.dir(o))},filterProducts(o=1){let e=`${p}/api/${_}/products?page=${o}`;const i=this.$route.query.category;i&&i!=="全部"&&(e=`${p}/api/${_}/products?page=${o}&category=${i}`),this.$http.get(e).then(n=>{this.filteredProducts=n.data.products,this.pagination=n.data.pagination,this.$router.push({path:"products",query:{category:i,page:o}})}).catch(n=>console.dir(n))},getCategories(){const o=[...new Set(this.products.map(e=>e.category))];this.categories=o},addToCart(o,e=1){const i={product_id:o,qty:e};this.$http.post(`${p}/api/${_}/cart`,{data:i}).then(n=>{console.log(n.data),this.getCart()}).catch(n=>console.log(n.data))},sortProducts(){let o=this.$route.query.category==="全部"?this.products:this.products.filter(e=>e.category===this.$route.query.category);this.minPrice!==null&&(o=o.filter(e=>e.price>=this.minPrice)),this.maxPrice!==null&&(o=o.filter(e=>e.price<=this.maxPrice)),this.selectedSort==="價格高到低"?this.filteredProducts=o.sort((e,i)=>i.price-e.price):this.selectedSort==="價格低到高"?this.filteredProducts=o.sort((e,i)=>e.price-i.price):this.filteredProducts=o},...V(k,["getCart"])},components:{pagination:B},mounted(){this.getProducts(),this.filterProducts()},computed:{...T(k,["carts"])},watch:{$route:{handler(o){o.name==="products"&&this.filterProducts(this.$route.query.page)},deep:!0}}},l=o=>(L("data-v-c7dfc2c7"),o=o(),N(),o),A={class:"container py-8"},M={class:"row gx-4 gy-3"},j={class:"col-md-4 col-12"},F={class:"p-3 bg-primary bg-opacity-25 border border-primary border-2 rounded-3 position-sticky product-menu",style:{top:"12%"}},H={class:"mb-4 d-md-block d-none"},O=l(()=>t("div",{class:"product-title"},[t("h4",null,"價格")],-1)),z={class:"d-flex gap-3"},G=l(()=>t("span",null,"-",-1)),J=l(()=>t("div",{class:"product-title"},[t("h4",null,"商品類型")],-1)),K={class:"px-3 w-md-auto w-100"},Q={class:"mb-1"},W={class:"col-md-8 col-12"},X={class:"row gy-2 border-bottom border-dark-subtle align-items-center py-2 px-md-0 px-3"},Y={class:"col-md-4 col-12"},Z=l(()=>t("option",{value:"照順序排列"},"照順序排列",-1)),tt=l(()=>t("option",{value:"價格低到高"},"價格低到高",-1)),et=l(()=>t("option",{value:"價格高到低"},"價格高到低",-1)),ot=[Z,tt,et],st=l(()=>t("div",{class:"col-md-8 col-12"},[t("h4",null,"[無線]耳罩式耳機")],-1)),rt={key:0},it={class:"row gy-4 py-4"},ct={style:{position:"relative",background:"#f1f1f1"}},dt=["src"],nt=["onClick"],lt={class:"card-body d-flex flex-column"},at={class:"mb-2 text-title"},ut={class:"text-text mb-2 fs-6"},pt={class:"d-flex align-items-center gap-3 mt-auto mb-2"},_t={class:"text-title text-muted fs-6"},ht={class:"text-title fs-6"},mt={key:1},gt=l(()=>t("div",{class:"text-center mt-4"},[t("h3",null,"找不到產品")],-1)),ft=[gt];function yt(o,e,i,n,r,c){const y=h("router-link"),w=h("RouterLink"),S=h("pagination");return d(),a("main",null,[t("div",{class:"banner-img d-flex justify-content-center align-items-center",style:I([{height:"500px"},{backgroundImage:`url(${r.bannerImg})`}])},null,4),t("div",A,[t("div",M,[t("div",j,[t("div",F,[t("div",H,[O,t("div",z,[t("div",null,[m(t("input",{class:"w-100 border-bottom border-dark bg-transparent p-2",type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>r.minPrice=s),onChange:e[1]||(e[1]=(...s)=>c.sortProducts&&c.sortProducts(...s)),placeholder:"最低"},null,544),[[b,r.minPrice]])]),G,t("div",null,[m(t("input",{class:"w-100 border-bottom border-dark bg-transparent p-2",type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>r.maxPrice=s),onChange:e[3]||(e[3]=(...s)=>c.sortProducts&&c.sortProducts(...s)),placeholder:"最高"},null,544),[[b,r.maxPrice]])])])]),t("div",null,[J,t("ul",K,[t("li",Q,[(d(),g(y,{to:{query:{category:"全部",page:1}},key:o.全部},{default:f(()=>[x(" 全部 ")]),_:1}))]),(d(!0),a(v,null,P(r.categories,s=>(d(),a("li",{class:"mb-1",key:s},[(d(),g(y,{to:{query:{category:s,page:1}},key:s},{default:f(()=>[x(u(s),1)]),_:2},1032,["to"]))]))),128))])])])]),t("div",W,[t("div",X,[t("div",Y,[m(t("select",{class:"w-100 p-2 border border-dark rounded-3 bg-primary bg-opacity-50","onUpdate:modelValue":e[4]||(e[4]=s=>r.selectedSort=s),onChange:e[5]||(e[5]=(...s)=>c.sortProducts&&c.sortProducts(...s))},ot,544),[[U,r.selectedSort]])]),st]),r.filteredProducts[r.filteredProducts.length-1]?(d(),a("div",rt,[t("div",it,[(d(!0),a(v,null,P(r.filteredProducts,s=>(d(),a("div",{class:"col-lg-4 col-md-6 col-12",key:s.id},[E(w,{to:`/product/${s.id}`,class:"card overflow-hidden"},{default:f(()=>[t("div",ct,[t("img",{src:s.imageUrl,class:"card-img-top",alt:""},null,8,dt),t("button",{type:"button",onClick:R(()=>c.addToCart(s.id),["prevent"]),class:"btn btn-primary text-white position-absolute bottom-0 end-0 card-button"}," 加入購物車 ",8,nt)]),t("div",lt,[t("h4",at,u(s.title),1),t("h4",ut,u(s.description1),1),t("div",pt,[t("del",_t,"NT$ "+u(c.currency(s.origin_price)),1),t("p",ht," NT$ "+u(c.currency(s.price)),1)])])]),_:2},1032,["to"])]))),128))]),r.pagination.total_pages!==1?(d(),g(S,{key:0,pages:r.pagination,onUpdatePage:c.filterProducts},null,8,["pages","onUpdatePage"])):q("",!0)])):(d(),a("div",mt,ft))])])])])}const wt=D($,[["render",yt],["__scopeId","data-v-c7dfc2c7"]]);export{wt as default};
